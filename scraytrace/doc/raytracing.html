<html><head><meta http-equiv="Content-Type" content="text/html; charset=ANSI_X3.4-1968"><title>Chapter&#160;2.&#160;Software Concepts</title><link rel="stylesheet" href="docbook.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><meta name="keywords" content="Solar corona, Simulation, Ray-Tracing"><link rel="start" href="index.html" title="Raytracing Software for the Simulation of the Solar Corona: User's Guide"><link rel="up" href="index.html" title="Raytracing Software for the Simulation of the Solar Corona: User's Guide"><link rel="prev" href="overview.html" title="Chapter&#160;1.&#160;Overview"><link rel="next" href="install.html" title="Chapter&#160;3.&#160;Install"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&#160;2.&#160;Software Concepts</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="overview.html">Prev</a>&#160;</td><th width="60%" align="center">&#160;</th><td width="20%" align="right">&#160;<a accesskey="n" href="install.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="raytracing"></a>Chapter&#160;2.&#160;Software Concepts</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="raytracing.html#ray:meth">1. Raytracing principle</a></span></dt><dd><dl><dt><span class="sect2"><a href="raytracing.html#ray:meth:type">1.1. Model representation</a></span></dt><dt><span class="sect2"><a href="raytracing.html#ray:meth:thom">1.2. Thomson scattering</a></span></dt><dt><span class="sect2"><a href="raytracing.html#ray:meth:meth">1.3. Raytracing methods</a></span></dt></dl></dd><dt><span class="sect1"><a href="raytracing.html#raycoord">2. Coordinate Systems</a></span></dt><dd><dl><dt><span class="sect2"><a href="raytracing.html#ray:coord:over:abs">2.1. Abolute coordinate system: ABS</a></span></dt><dt><span class="sect2"><a href="raytracing.html#ray:coord:over:obs">2.2. Observer coordinate system: OBS</a></span></dt><dt><span class="sect2"><a href="raytracing.html#ray:coord:over:nps">2.3. Electron density coordinate system: NPS</a></span></dt><dt><span class="sect2"><a href="raytracing.html#ray:coord:wcs">2.4. WCS Compliance</a></span></dt><dt><span class="sect2"><a href="raytracing.html#ray:coord:quat">2.5. Quaternions</a></span></dt></dl></dd></dl></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ray:meth"></a>1.&#160;Raytracing principle</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ray:meth:type"></a>1.1.&#160;Model representation</h3></div></div></div><p>We can define two types of model representations: geometric function and density cube. The octree compression and voxel list are extensions of the density cube representation.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="ray:meth:type:geo"></a>1.1.1.&#160;Geometric model</h4></div></div></div><p>The model is defined by a geometric function that gives the electron density for a given position x,y,z in space. The geometric function generally will have some extra parameters in order to be able modify the geometrical aspect of the model.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="ray:meth:type:cube"></a>1.1.2.&#160;Density cube</h4></div></div></div><p>The electron density is given by a three-dimensional density cube. Each voxel of the cube contains a sampled value of the electron density at a point of the space. The cube can be either regularly or irregularly gridded. The advantage of the density cube is that it can contain the representation of a complex structure than would not be possible to describe simply with a geometrical function. On the other hand, if a fine resolution is needed in order to represent the fine details of a coronal structure for example, the storage size of the density cube can be a limitation. The storage size varies with the cube of the resolution. To double the resolution <span class="inlinemediaobject"><img src="storreso.png"></span> times more memory is necessary. Note that density cube is generally the format used to store the product of a tomographic or stereo view inversion program.
</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="ray:meth:type:octree"></a>1.1.3.&#160;Octree compression</h4></div></div></div><p>The octree compression is a method use to compress the size required to store a density cube. It can be compared to the quadtree compression for a two dimensional image. If between 4 contiguous voxels of the cube the density variation is small enough, the octree compression consist in merging these 4 voxels in one single super voxel, containing then only one electron density sample instead of 4. This compression is very efficient when large area of the space are empty, when a cube contains a localized coronal structure for example. For descritions and application of octree compression see [<span class="citation">1997adass...6..230V</span>].
 Algorithm for fast rendering of octree compressed cubes also exist (CITE)</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="ray:meth:type:list"></a>1.1.4.&#160;Voxel list</h4></div></div></div><p>A voxel list is a list that gives the position, size and density of the voxels. Only the necessary information to represent a model is stored. It is useful for models of a localized structure, or when a structure is filamentary for example. 
</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ray:meth:thom"></a>1.2.&#160;Thomson scattering</h3></div></div></div><p>
The K corona is an ionized gas so roughly half of the particles present in this gas are free electrons. These electron are accelerated by electromagnetic field passing through the corona. As a result, they will scatter the solar light. This is because of this process that we see the corona in white-light. It is defined as the Thomson scattering. Note that light scattered by this process is polarized. (MINAERT, VAN DE HULST, BILLINGS) treated the problem of Thomson scattering in the solar corona. They established two equations that give the total and polarized brightness scattered from the solar photosphere by a localized electron density. It allows to calculate the brightness of the corona as seen from a telescope if we integrate along the lines of sight of this telescope. The Solar Corona Ray-Tracing program (SCoRT) is an implementation of these equations.
</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ray:meth:meth"></a>1.3.&#160;Raytracing methods</h3></div></div></div><p>There are two methods to perform numerically the raytracing: ray-casting and splating. The choice of the method depends on the type of model we need to simulate: geometric function or density cube.
Both methods have advantage and inconvenient. Processing speed is the major factor that will govern the choice.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="ray:meth:meth:cast"></a>1.3.1.&#160;Ray-Casting</h4></div></div></div><p>At each pixel of the image corresponds a line of sight (LOS). For each pixel of the image we scan the space along the corresponding LOS. At each point of the LOS we get the electron density of the model and calculate the Thomson scattering geometric factor in order to get the corresponding brightness scattered by the electron density at that point of the space. Finally, the pixel value is the sum of all the contributions along the LOS.
</p><p>Ray-casting is used for geometric model rendering. The major problem is that the program scan all the space (actually the space delimited by the user's boundaries) and can waste processing time where the space is empty if the model structure is localized. Adaptative step integration can be used though to speed up the rendering. Processing speed also mainly depend on the complexity of the geometric function. In some cases, the computation of a density cube could be suitable first and then render the cube on a second stage, eventhough we would lose the advantage of the geometric function which allows to change the model parameters for each rendering.
</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="ray:meth:meth:splat"></a>1.3.2.&#160;Splatting</h4></div></div></div><p>
Splatting is particularly suitable for density cube rendering. We calculate the projected area of a density cube voxel on the image (instrument virtual CCD). This projection can be considered as the "shadow" of the voxel on the image. Then we scan the image pixels covered by the projection of the voxel. For each of the pixel we calculate the Thomson scattering geometric factor corresponding to the middle point of the LOS passing through the voxel. Then the scattered brightness is calculated and added to the pixel. We proceed voxel by voxel so that the final image is the sum of all the voxel contribution.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Octree compressed density cube and voxel list could be rendered as well using this method eventhough performances can be increased especially in the case of octree compressed cubes (CITE REFERENCES).</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Density cube can also be rendered with ray-casting method. In that case for each point of the LOSes an interpolation is performed to obtain the density at that point of the space depending on the density of the nearest neighbor voxels of the density cube. This rendering method can be useful if we set a coarse LOS step to get a quick first overview of the cube.</p></td></tr></table></div></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="raycoord"></a>2.&#160;Coordinate Systems</h2></div></div></div><p>All the coordinate systems are direct and orthonormals. Figure <a href="raytracing.html#coordsys" title="Figure&#160;2.1.&#160;Coordinate systems.">Figure&#160;2.1, &#8220;Coordinate systems.&#8221;</a> shows a summary of the 3 coordinate systems described in this section.</p><div class="figure"><a name="coordsys"></a><p class="title"><b>Figure&#160;2.1.&#160;Coordinate systems.</b></p><div class="mediaobject"><img src="coordsys01.png" alt="Coordinate systems"></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ray:coord:over:abs"></a>2.1.&#160;Abolute coordinate system: ABS</h3></div></div></div><p>This is the coordinate system that is the reference for all the other systems described bellow: translation and rotation of the other coordinate systems will be calculated with respect to this one. The origin is at the center of the Sun.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ray:coord:over:obs"></a>2.2.&#160;Observer coordinate system: OBS</h3></div></div></div><p>Defines the position and orientation of the observer with respect to the absolute coordinate system. We use the optics convention for the axis of the virtual imaging telescope:
			
			</p><div class="variablelist"><dl><dt><span class="term">Ox</span></dt><dd><p>Vertical axis of the CCD camera.</p></dd><dt><span class="term">Oy</span></dt><dd><p>Horizontal axis of the CCD camera.</p></dd><dt><span class="term">Oz</span></dt><dd><p>Optical axis of the telescope.</p></dd></dl></div><p> 
			
		</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ray:coord:over:nps"></a>2.3.&#160;Electron density coordinate system: NPS</h3></div></div></div><p>Defines the position and orientation of the electron density cube or model with respect to the absolute coordinate system.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ray:coord:wcs"></a>2.4.&#160;WCS Compliance</h3></div></div></div><p>TO BE IMPLEMENTED</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ray:coord:quat"></a>2.5.&#160;Quaternions</h3></div></div></div><p>TO BE IMPLEMENTED</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="overview.html">Prev</a>&#160;</td><td width="20%" align="center">&#160;</td><td width="40%" align="right">&#160;<a accesskey="n" href="install.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&#160;1.&#160;Overview&#160;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&#160;Chapter&#160;3.&#160;Install</td></tr></table></div></body></html>
